# Updating .bgen files
Initial analyses using Limix required bgen v1.2 as input, so the early pipeline updated bgen files to this format while updating SNP positions to b38. While early scripts aimed to update the whole cohort, this proved too intensive for qctool and the process crashed. Instead, updated bgen files were made for samples with RNA seq data only. Early scripts are numbered 01 to 04. 

# Pipeline
`05_make_small_bgen.sh` is the whole pipeline to make these smaller bgen files for analysis, requiring as input:
* The original b37 bgen files for the whole cohort
* A list of samples to retain (`rna_seq_phase1-2_affy_ids.txt`, generated by `genotypes/1_1_get_affy_ids_phase2.r`)
* A list of SNPs to retain (`rna_seq_phase1-2_affy_ids.txt`, generated by 02_generate_snp_ids.R). These are non-duplicated SNPs that successfully lifted over to b38.

The new .bgen files are updated to version 1.2 with sample ids embedded, duplicates removed and every variant assigned a unique alternate identifier. Genomic positions are updated to b38 of the human genome to match the mapping of the RNA seq data. **Alleles are NOT updated.** This is because aligning strands is time consuming.

The new alternate identifier is: `[chromosome]_[position_b38]_[A1]_[A2]:[rsid]`
Where:
* A1 is alphabeticaly before A2 for SNPs or
* A1 is the shorter allele for indels

Where a variant has no rsid, the alternate identifier is `[chromosome]_[position_b38]_[A1]_[A2]` and the RSID field is also set to this value.

**Note: These files are in the process of being consolidated for clarity in a new folder: genotypes**
